FROM debian:bookworm-slim

RUN apt update && apt install -y \
    socat \
    libc6 \
    && rm -rf /var/lib/apt/lists/*

RUN useradd -m ctf

WORKDIR /home/ctf

COPY chall flag.txt ./

RUN chmod 755 chall \
    && chmod 444 flag.txt \
    && chown -R root:root ./

USER ctf
EXPOSE 9001
CMD ["socat", \
     "TCP-LISTEN:9001,reuseaddr,fork", \
     "EXEC:/home/ctf/chall,stderr"]
